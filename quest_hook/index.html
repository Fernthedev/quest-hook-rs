<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="quest_hook"><meta name="keywords" content="rust, rustlang, rust-lang, quest_hook"><title>quest_hook - Rust</title><link rel="stylesheet" type="text/css" href="../normalize.css"><link rel="stylesheet" type="text/css" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../light.css"  id="themeStyle"><link rel="stylesheet" type="text/css" href="../dark.css" disabled ><link rel="stylesheet" type="text/css" href="../ayu.css" disabled ><script id="default-settings" ></script><script src="../storage.js"></script><script src="../crates.js"></script><noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../favicon.svg"><style type="text/css">#crate-search{background-image:url("../down-arrow.svg");}</style></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu" role="button">&#9776;</div><a href='../quest_hook/index.html'><div class='logo-container rust-logo'><img src='../rust-logo.png' alt='logo'></div></a><h2 class="location">Crate quest_hook</h2><div class="block version"><div class="narrow-helper"></div><p>Version 0.1.0</p></div><div class="sidebar-elems"><a id="all-types" href="all.html"><p>See all quest_hook's items</p></a><div class="block items"><ul><li><a href="#enums">Enums</a></li><li><a href="#traits">Traits</a></li><li><a href="#functions">Functions</a></li></ul></div><div id="sidebar-vars" data-name="quest_hook" data-ty="mod" data-relpath=""></div><script defer src="sidebar-items.js"></script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu" title="themes"><img width="18" height="18" alt="Pick another theme!" src="../brush.svg"></button><div id="theme-choices" role="menu"></div></div><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" disabled autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><button type="button" id="help-button" title="help">?</button><a id="settings-menu" href="../settings.html" title="settings"><img width="18" height="18" alt="Change settings" src="../wheel.svg"></a></div></form></nav><section id="main" class="content"><h1 class="fqn"><span class="in-band">Crate <a class="mod" href="#">quest_hook</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span><span class="out-of-band"><span id="render-detail"><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span><a class="srclink" href="../src/quest_hook/lib.rs.html#1-92" title="goto source code">[src]</a></span></h1><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><h1 id="quest_hook" class="section-header"><a href="#quest_hook">quest_hook</a></h1>
<p>A library for writing (mostly) memory safe mods for Oculus Quest Unity il2cpp games. Mods using this library may be loaded using <a href="https://github.com/sc2ad/QuestLoader">QuestLoader</a>.</p>
<p><a href="https://stackdoubleflow.github.io/quest-hook-rs/quest_hook/"><img src="https://img.shields.io/github/workflow/status/StackDoubleFlow/quest-hook-rs/Docs?color=blue&amp;label=docs&amp;style=for-the-badge" alt="Docs" /></a> <a href="https://github.com/StackDoubleFlow/quest-hook-rs/actions/workflows/tests.yml"><img src="https://img.shields.io/github/workflow/status/StackDoubleFlow/quest-hook-rs/Tests?label=tests&amp;style=for-the-badge" alt="Tests" /></a></p>
<h2 id="platform-support" class="section-header"><a href="#platform-support">Platform support</a></h2>
<p>Despite its name and initial target and scope, this library supports modding most il2cpp games, as long as you have a way to load the mods.</p>
<h3 id="unity-versions" class="section-header"><a href="#unity-versions">Unity versions</a></h3>
<ul>
<li>Unity 2019</li>
<li>Unity 2018</li>
</ul>
<h3 id="targets" class="section-header"><a href="#targets">Targets</a></h3>
<ul>
<li>Android ARMv8</li>
<li>Android ARMv7</li>
<li>Windows x64</li>
<li>Windows x86</li>
<li>Linux x64</li>
<li>Linux x86</li>
</ul>
<h2 id="usage" class="section-header"><a href="#usage">Usage</a></h2>
<p>Simply add the library as a dependency to your <code>Cargo.toml</code> and set the crate type to a C dynamic library. You will need to use a nightly version in order to compile <code>quest_hook</code>. <strong>Don’t forget to select a Unity version</strong>.</p>
<div class="example-wrap"><pre class="language-toml"><code>[lib]
crate-type = [&quot;cdylib&quot;]

[dependencies]
quest_hook = { git = &quot;https://github.com/StackDoubleFlow/quest-hook-rs.git&quot;, features = [&quot;unity2019&quot;] }</code></pre></div>
<p>This library is still under heavy development and breaking changes are frequent. To avoid dealing with those, you can <a href="https://doc.rust-lang.org/cargo/reference/specifying-dependencies.html#specifying-dependencies-from-git-repositories">pin the dependency to a specific commit or tag</a>.</p>
<h2 id="example" class="section-header"><a href="#example">Example</a></h2>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use</span> <span class="ident">quest_hook::hook</span>;
<span class="kw">use</span> <span class="ident">quest_hook::libil2cpp</span>::{<span class="ident">Il2CppObject</span>, <span class="ident">Il2CppString</span>};
<span class="kw">use</span> <span class="ident">tracing::debug</span>;

<span class="attribute">#[<span class="ident">no_mangle</span>]</span>
<span class="kw">pub</span> <span class="kw">extern</span> <span class="string">&quot;C&quot;</span> <span class="kw">fn</span> <span class="ident">setup</span>() {
    <span class="ident">quest_hook::setup</span>(<span class="string">&quot;hello world&quot;</span>);
}

<span class="attribute">#[<span class="ident">hook</span>(<span class="string">&quot;UnityEngine.SceneManagement&quot;</span>, <span class="string">&quot;SceneManager&quot;</span>, <span class="string">&quot;SetActiveScene&quot;</span>)]</span>
<span class="kw">fn</span> <span class="ident">set_active_scene</span>(<span class="ident">scene</span>: <span class="kw-2">&amp;</span><span class="kw-2">mut</span> <span class="ident">Il2CppObject</span>) <span class="op">-</span><span class="op">&gt;</span> <span class="ident">bool</span> {
    <span class="kw">let</span> <span class="ident">name</span>: <span class="kw-2">&amp;</span><span class="ident">Il2CppString</span> <span class="op">=</span> <span class="ident">scene</span>.<span class="ident">invoke</span>(<span class="string">&quot;get_name&quot;</span>, ()).<span class="ident">unwrap</span>();
    <span class="macro">debug!</span>(<span class="string">&quot;Hello, {}!&quot;</span>, <span class="ident">name</span>);

    <span class="ident">set_active_scene</span>.<span class="ident">original</span>(<span class="ident">scene</span>)
}

<span class="attribute">#[<span class="ident">no_mangle</span>]</span>
<span class="kw">pub</span> <span class="kw">extern</span> <span class="string">&quot;C&quot;</span> <span class="kw">fn</span> <span class="ident">load</span>() {
    <span class="ident">set_active_scene</span>.<span class="ident">install</span>().<span class="ident">unwrap</span>();
}</code></pre></div>
<p>Check out the <a href="./examples/"><code>examples</code></a> directory for more examples.</p>
<h2 id="cargo-features" class="section-header"><a href="#cargo-features">Cargo features</a></h2>
<ul>
<li><code>unity2019</code>, <code>unity2018</code> - Unity version the targetted game uses</li>
<li><code>util</code> - Adds small utility functions for setting up logging and the like</li>
<li><code>cache</code> - Enables class and method caching to greatly improve lookup speed at the cost of slightly higher memory consumption</li>
<li><code>trace</code> - Adds <code>tracing</code> instrumentation to many internal function</li>
</ul>
<h2 id="contributing" class="section-header"><a href="#contributing">Contributing</a></h2>
<p>Contributions are welcome, especially to the documentation and examples. Most of the discussions regarding the development of this library happen in the <code>#quest-mod-dev</code> channel of the <a href="https://discord.gg/beatsabermods">BSMG Discord server</a>.</p>
<p>Everything that can be reasonably be done in Rust should be done in Rust. The reasons behind this choice are improving readability and providing a more Rust-friendly API, and not safety. This library is, by nature, extremely unsafe, and contains a lot of unsafe code.</p>
<p>A decent understanding of both Rust and C++ is required for most work on the library. The main reference used for development is libil2cpp, which is written in C++. Another excellent resource is <a href="https://github.com/sc2ad/beatsaber-hook">beatsaber-hook</a>, also written in C++.</p>
<p>This library is mainly developed using Visual Studio Code with <a href="https://rust-analyzer.github.io/">rust-analyzer</a>. Code style, quality and documentation are enforced using rustfmt and clippy via GitHub Actions. Due to the nature of this library, we can sadly not really unit test most of the features, but are open to suggestions to improve this aspect.</p>
<h3 id="project-structure" class="section-header"><a href="#project-structure">Project structure</a></h3>
<ul>
<li><code>libil2cpp</code> - Abstractions and raw bindings for libil2cpp. This is where most of the code and functionality lives.</li>
<li><code>inline_hook</code> - Cross-platform function hooking abstraction. This is where support for more targets can be added.</li>
<li><code>proc_macros</code> - Home of the <code>hook</code> macro implementation, and of various internally used ones.</li>
</ul>
<h2 id="license" class="section-header"><a href="#license">License</a></h2>
<p>quest_hook is licensed under the <a href="./LICENSE">MIT License</a>.</p>
<h2 id="credits" class="section-header"><a href="#credits">Credits</a></h2>
<p>This library wouldn’t exist without the invaluable help, feedback and previous work from <a href="https://github.com/sc2ad">Sc2ad</a>.</p>
</div></details><h2 id="reexports" class="section-header"><a href="#reexports">Re-exports</a></h2>
<div class="item-table"><div class="item-left import-item"><code>pub use <a class="mod" href="../libil2cpp/index.html" title="mod libil2cpp">libil2cpp</a>;</code></div><div class="item-right docblock-short"></div></div><h2 id="enums" class="section-header"><a href="#enums">Enums</a></h2>
<div class="item-table"><div class="item-left module-item"><a class="enum" href="enum.HookInstallError.html" title="quest_hook::HookInstallError enum">HookInstallError</a></div><div class="item-right docblock-short"><p>Possible errors when installing a hook</p>
</div></div><h2 id="traits" class="section-header"><a href="#traits">Traits</a></h2>
<div class="item-table"><div class="item-left module-item"><a class="trait" href="trait.Hook.html" title="quest_hook::Hook trait">Hook</a></div><div class="item-right docblock-short"><p>Trait implemented by all hooks to facilitate generic programming</p>
</div></div><h2 id="functions" class="section-header"><a href="#functions">Functions</a></h2>
<div class="item-table"><div class="item-left module-item"><a class="fn" href="fn.panic_hook.html" title="quest_hook::panic_hook fn">panic_hook</a></div><div class="item-right docblock-short"><p>Returns a panic handler, optionally with backtrace and spantrace capture.</p>
</div><div class="item-left module-item"><a class="fn" href="fn.setup.html" title="quest_hook::setup fn">setup</a></div><div class="item-right docblock-short"><p>Sets up Android logging with the provided tag and default settings using
<a href="https://docs.rs/tracing/0.1.26/tracing/index.html" title="tracing"><code>tracing</code></a>. Also sets up panic handling with backtrace and spantrace
capture enabled.</p>
</div></div><h2 id="attributes" class="section-header"><a href="#attributes">Attribute Macros</a></h2>
<div class="item-table"><div class="item-left module-item"><a class="attr" href="attr.hook.html" title="quest_hook::hook attr">hook</a></div><div class="item-right docblock-short"><p>Creates an inline hook at a C# method.</p>
</div></div></section><section id="search" class="content hidden"></section><div id="rustdoc-vars" data-root-path="../" data-current-crate="quest_hook" data-search-index-js="../search-index.js" data-search-js="../search.js"></div>
    <script src="../main.js"></script>
</body></html>